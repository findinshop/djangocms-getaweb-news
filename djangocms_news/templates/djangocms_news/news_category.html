{% extends "layouts/sidebar_left.html" %}
{% load cms_tags sekizai_tags thumbnail cmsnews %}

{% block title %}News{% endblock %}

{% block head %}
    <link href="{% newsindex_url %}" rel="canonical" />
{% endblock %}

{% block sidebar %}
    {% include "djangocms_news/news_filter.html" with filter_tag='news' set_category=category %}
{% endblock %}

{% block content %}
    {% addtoblock "css" %}
        <link rel="stylesheet" href="{{ STATIC_URL }}css/masonry.css">
    {% endaddtoblock %}

    {% addtoblock "js" %}
        <script src="{{ STATIC_URL }}js/imagesloaded.pkgd.min.js"></script>
        <script src="{{ STATIC_URL }}js/masonry.pkgd.min.js"></script>
    {% endaddtoblock %}

    <h1>News</h1>
    <div id="masonry-loader">
        <i class="fa fa-spinner fa-spin fa-5x"></i>
    </div>
    <div id="masonry-container">
        {% for news in object_list %}
            {% if news.active %}
                <div class="masonry-item one-third{% for cat in news.news_categories.all %} news-{{ cat.pk }}{% endfor %}">
                    <div class="masonry-item-image">
                        <a href="{% newsitem_url news.slug %}">
                            {% if news.newsimage_set.all %}
                                {% with news.newsimage_set.all|first as newsimage %}
                                    <img src="{{ newsimage.image|thumbnail_url:'masonry' }}" alt="{{ news.title }}" />
                                {% endwith %}
                            {% endif %}
                            <div class="masonry-item-title">{{ news.title }} <i class="fa fa-angle-double-right"></i></div>
                        </a>
                    </div>

                    <div class="masonry-item-description">
                        {% if news.abstract %}
                            {{ news.abstract }}
                        {% else %}
                            {{ news.content }}
                        {% endif %}
                    </div>
                </div>
            {% endif %}
    {% endfor %}
    </div>
    <div id="masonry-no-content">
        <i class="fa fa-meh-o fa-5x fa-fw"></i> <span>Keine Inhalte gefunden!</span>
    </div>
{% endblock %}